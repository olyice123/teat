def is_valid_number(number):
    """‡πÄ‡∏ä‡πá‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏•‡∏Ç‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 000-999 ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å"""
    return number.isdigit() and 0 <= int(number) <= 999 and len(number) == 3

def main():
    print("üìå ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏´‡∏ß‡∏¢‡πÉ‡∏ï‡πâ‡∏î‡∏¥‡∏ô (‡πÄ‡∏•‡∏Ç 000 - 999)")
    print("‡∏û‡∏¥‡∏°‡∏û‡πå 'exit' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö\n")

    purchases = {}  # ‡πÄ‡∏Å‡πá‡∏ö‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏•‡∏Ç

    while True:
        number = input("‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å (000-999): ").zfill(3)
        if number.lower() == 'exit':
            break
        if not is_valid_number(number):
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 000 ‡∏ñ‡∏∂‡∏á 999 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô\n")
            continue

        try:
            amount = float(input(f"‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏Ç {number}: "))
            if amount <= 0:
                print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0\n")
                continue
        except ValueError:
            print("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç\n")
            continue

        # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠
        if number not in purchases:
            purchases[number] = 0
        purchases[number] += amount

        # ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏¥‡∏ô 100
        if purchases[number] > 100:
            print(f"‚ö†Ô∏è ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç {number} ‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 100 ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß ({purchases[number]:.2f} ‡∏ö‡∏≤‡∏ó)\n")
        else:
            print(f"‚úÖ ‡∏£‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡∏Ç {number} ‡πÅ‡∏•‡πâ‡∏ß (‡∏£‡∏ß‡∏° {purchases[number]:.2f} ‡∏ö‡∏≤‡∏ó)\n")

    # ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏ö
    print("\nüìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:")
    for number, total in sorted(purchases.items()):
        print(f"‡πÄ‡∏•‡∏Ç {number} : {total:.2f} ‡∏ö‡∏≤‡∏ó")

if __name__ == "__main__":
    main()
